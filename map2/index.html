<!DOCTYPE html>
<meta charset="utf-8">

<!-- Load d3.js -->
<script src="https://d3js.org/d3.v4.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
<script src="https://d3js.org/d3-geo-projection.v2.min.js"></script>

<!-- Create an element where the map will take place -->
<!--<h1 style="text-align: center">COVID-19 Fälle in Österreich</h1> -->
<svg id="my_dataviz" width="1100" height="1120"></svg>

<script>
var svg = d3.select("svg")

// handler functions for map.js and color_legend.js
function handleMouseover(d, i){
  var cases2 =  cases[d.properties.name]
  tooltip_map_update(d.properties.name, cases2.freq, cases2.population, cases2.ratio)
  color_legend.selectAll("#circle_"+i).transition()
    .attr("r", 20).attr("opacity", .6).attr("stroke-width", 2)
  map.selectAll("#path_"+i).transition()
    .attr("stroke-width", 5)
  bar.selectAll("." + cases2.bl).transition()
    .attr("stroke-width", 5)
}
function handleMouseLeave(d, i){
  var cases2 =  cases[d.properties.name]
  color_legend.selectAll("#circle_"+i).transition()
    .attr("r", 10).attr("opacity", .7).attr("stroke-width", .5)
  map.selectAll("#path_"+i).transition()
    .attr("stroke-width", 1)
  bar.selectAll("." + cases2.bl).transition()
    .attr("stroke-width", 1)
}

// transform ratios to a [0, 1] scale
function scale_cases(d){
  //return 1-cases[d.properties.name].ratio/300
  return 1-cases[d.properties.name].ratio/260
  //return 1.5-Math.log(cases[d.properties.name].ratio)/4.2
}
</script>  

<script src="data.js"></script>
<script src="map.js"></script>
<script src="color_legend.js"></script>
<script src="bar.js"></script>
